clear 
clc
syms s
N1(s) = (s*(s-1))/2;
N2(s) = (1-s)*(1+s);
N3(s) = (s*(s+1))/2;

n=5;
h=1/n;

N11=diff(N1)/(h/2);
N21=diff(N2)/(h/2);
N31=diff(N3)/(h/2);



a = ((N11^2) + (N1^2))*(h/2);
b = (N11*N21 + N1*N2)*(h/2);
c = (N11*N31 + N1*N3)*(h/2);
d = ((N21^2) + (N2^2))*(h/2);
e = (N21*N31 + N2*N3)*(h/2);
f = ((N31^2) + (N3^2))*(h/2);


K11 = int(a,-1,1)
K12 = int(b,-1,1)
K13 = int(c,-1,1)
K22 = int(d,-1,1)
K23 = int(e,-1,1)
K33 = int(f,-1,1)




F1=2*(int(N1,-1,1))*0.1
F2=2*(int(N2,-1,1))*0.1
F3=2*(int(N3,-1,1))*0.1

B=[F1;F2;F3];
Z=zeros(2*n+1,1);

for i=1:n
    for r=1:3
        Z(r+2*(i-1))=Z(r+2*(i-1))+B(r,1);
    end
end
Z(2*n+1,1)=Z(2*n+1,1)+2;
Z



A=[877/75,-333/25,83/50;-333/25,2008/75,-333/25;83/50,-333/25,877/75];


K=zeros(2*n+1)

for i=1:n
        for r=1:3
            for c=1:3
                K(r+2*(i-1),c+2*(i-1))=A(r,c)+K(r+2*(i-1),c+2*(i-1));
            end

        end
    end
K

for i=1:2*n+1
    Z(i,1)=Z(i,1)-K(i,1)*3;
end
Z(1,1)=3;
Z

for i=1:2*n+1
    K(1,i)=0;
    K(i,1)=0;
end
K(1,1)=1;

d=inv(K)*Z

syms u(x) u_an(x)
%u(x) = piecewise ( 0<=x<=0.125,  d(1,1)+(d(3,1)-d(1,1))*(x)/0.125,  0.125<=x<=0.25,  d(3,1)+(d(5,1)-d(3,1))*(x-0.125)/0.125 , 0.25<=x<=0.375,  d(5,1)+(d(7,1)-d(5,1))*(x-0.25)/0.125 , 0.375<=x<=50,  d(7,1)+(d(9,1)-d(7,1))*(x-0.375)/0.125, 0.5<=x<=0.625 , d(9,1)+(d(11,1)-d(9,1))*(x-0.5)/0.125, 0.625<=x<=0.75,d(11,1)+(d(13,1)-d(11,1))*(x-0.625)/0.125, 0.75<=x<=0.875, d(13,1)+(d(15,1)-d(13,1))*(x-0.75)/0.125, 0.875<=x<=1, d(15,1)+(d(17,1)-d(15,1))*(x-0.875)/0.125); 
c1=(1+2*exp(1))/(1+exp(2));
c2=(exp(2)-2*exp(1))/(1+exp(2));

u_an(x)=piecewise(0<=x<=1,c1*exp(x)+c2*exp(-x)+2);
plot(x,d)
hold on
fplot(u_an)
hold off




%e=int(((u-u_an)^2+(diff(u-u_an))^2),0,1)/int((u_an^2+(diff(u_an))^2),0,1);
%e=e^(0.5);
%e=log(e);
%vpa(e,6)

%figure(1)
%fplot(u)
%hold on
%fplot(u_an)
%hold off

%figure(2)
%error=u-u_an;
%fplot(error)


