syms s
N1(s) = ((9*s^3)-(9*s^2)-s+1)*(-1/16);
N2(s) = ((3*s^3)-(s^2)-(3*s)+1)*(9/16);
N3(s) = ((3*s^3)+(s^2)-(3*s)-1)*(-9/16);
N4(s) = ((9*s^3)+(9*s^2)-s-1)*(1/16);

N11=diff(N1)/0.1;
N21=diff(N2)/0.1;
N31=diff(N3)/0.1;
N41=diff(N4)/0.1;

int(N11^2,-1,1)
a = ((N11^2) + (N1^2))*0.1;
b = (N11*N21 + N1*N2)*0.1;
c = (N11*N31 + N1*N3)*0.1;
d = (N11*N41 + N1*N4)*0.1;
e = ((N21^2) + (N2^2))*0.1;
f = (N21*N31 + N2*N3)*0.1;
g = (N21*N41 + N2*N4)*0.1;
h = ((N31^2) + (N3^2))*0.1;
i = (N31*N41 + N3*N4)*0.1;
j = ((N41^2)  + (N4^2))*0.1;


K11 = int(a,-1,1)
K12 = int(b,-1,1)
K13 = int(c,-1,1)
K14 = int(d,-1,1)
K22 = int(e,-1,1)
K23 = int(f,-1,1)
K24 = int(g,-1,1)
K33 = int(h,-1,1)
K34 = int(i,-1,1)
K44 = int(j,-1,1)

A=[K11,K12,K13,K14 ; K12,K22,K23,K24; K13,K23,K33,K34; K14,K24,K34,K44]

F1=2*(int(N1,-1,1))*0.1
F2=2*(int(N2,-1,1))*0.1
F3=2*(int(N3,-1,1))*0.1
F4=2*(int(N4,-1,1))*0.1

B=[F1;F2;F3;F4];
Z=zeros(16,1);

for i=1:5
    for r=1:4
        Z(r+3*(i-1))=Z(r+3*(i-1))+B(r,1);
    end
end
Z(16,1)=Z(16,1)+2;
Z;

K=zeros(16);


for i=1:5
        for r=1:4
            for c=1:4
                K(r+3*(i-1),c+3*(i-1))=A(r,c)+K(r+3*(i-1),c+3*(i-1));
            end

        end
    end
K;

for i=1:11
    Z(i,1)=Z(i,1)-K(i,1)*3;
end
Z(1,1)=3;

for i=1:16
    K(1,i)=0;
    K(i,1)=0;
end
K(1,1)=1;

d=inv(K)*Z